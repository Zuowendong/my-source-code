{"version":3,"file":"vue.js","sources":["../src/observer/index.js","../src/initState.js","../src/init.js","../src/index.js"],"sourcesContent":["export function observer(data) {\r\n\t// console.log(data);\r\n\tif (typeof data != \"object\" || data == null) return data;\r\n\t// 对象\r\n\treturn new Observer(data);\r\n}\r\n\r\n// vue2 对 对象 劫持 使用 Object.defineProperty  -> 缺点: 只能对 对象中一个属性 进行劫持\r\n\r\nclass Observer {\r\n\tconstructor(value) {\r\n\t\tthis.walk(value); // 遍历 对 对象一层中每个属性劫持\r\n\t}\r\n\twalk(data) {\r\n\t\t// { msg: 'Hello', info: {name: 'jack'}}\r\n\t\tlet keys = Object.keys(data);\r\n\t\tfor (let i = 0; i < keys.length; i++) {\r\n\t\t\tconst key = keys[i]; // msg\r\n\t\t\tconst value = data[key]; // Hello\r\n\t\t\tdefineReactive(data, key, value);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// 对 对象中的属性 进行劫持\r\nfunction defineReactive(data, key, value) {\r\n\tobserver(value); // 深度代理 -> 递归处理当前属性的值 (如果还是个对象的话) -> {name: 'jack'}\r\n\tObject.defineProperty(data, key, {\r\n\t\tget() {\r\n\t\t\tconsole.log(\"获取\");\r\n\t\t\treturn value;\r\n\t\t},\r\n\t\tset(newValue) {\r\n\t\t\tconsole.log(\"设置\");\r\n\t\t\tif (newValue === value) return;\r\n\t\t\tobserver(newValue); // 处理 对象赋的 新值不响应 问题  -> vm._data.info = { name: \"tom\" } name属性不响应\r\n\t\t\tvalue = newValue;\r\n\t\t},\r\n\t});\r\n}\r\n","import { observer } from \"./observer/index\";\r\n\r\nexport function initState(vm) {\r\n\tlet opts = vm.$options;\r\n\tconsole.log(opts);\r\n\t// 各配置项初始化\r\n\tif (opts.props) {\r\n\t\tinitProps(vm);\r\n\t}\r\n\tif (opts.data) {\r\n\t\tinitData(vm);\r\n\t}\r\n\tif (opts.watch) {\r\n\t\tinitWatch(vm);\r\n\t}\r\n\tif (opts.computed) {\r\n\t\tinitComputed(vm);\r\n\t}\r\n\tif (opts.methods) {\r\n\t\tinitMethods(vm);\r\n\t}\r\n}\r\n\r\nfunction initProps() {}\r\nfunction initWatch() {}\r\nfunction initComputed() {}\r\nfunction initMethods() {}\r\n\r\n// 对 vue2 data 进行初始化\r\nfunction initData(vm) {\r\n\t// console.log(\"data初始化\", vm); // data两种类型情况 : 1.对象 2.函数(执行函数返回对象)\r\n\tlet data = vm.$options.data;\r\n\tdata = vm._data = typeof data === \"function\" ? data.call(vm) : data; // this指向问题  -> 指向vm实例\r\n\r\n\t// 对data数据进行劫持\r\n\tobserver(data);\r\n}\r\n","import { initState } from \"./initState\";\r\n\r\nexport function initMixin(Vue) {\r\n\tVue.prototype._init = function (options) {\r\n\t\t// console.log(\"vue\", options);\r\n\t\tlet vm = this; // vue实例\r\n\t\tvm.$options = options; // 挂载options方便后续使用\r\n\t\t// 初始化状态\r\n\t\tinitState(vm);\r\n\t};\r\n}\r\n","import { initMixin } from \"./init\";\r\n\r\nfunction Vue(options) {\r\n  // 初始化\r\n  this._init(options);\r\n}\r\n\r\ninitMixin(Vue);\r\n\r\nexport default Vue;\r\n"],"names":["observer","data","Observer","value","walk","keys","Object","i","length","key","defineReactive","defineProperty","get","console","log","set","newValue","initState","vm","opts","$options","props","initData","watch","computed","methods","_data","call","initMixin","Vue","prototype","_init","options"],"mappings":"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"}